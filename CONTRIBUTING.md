# Contributing to rspress-language-tabs

Thank you for your interest in contributing! This document provides guidelines and instructions for contributing to this project.

## Table of Contents

- [Code of Conduct](#code-of-conduct)
- [Getting Started](#getting-started)
- [Development Setup](#development-setup)
- [Making Changes](#making-changes)
- [Testing](#testing)
- [Commit Message Guidelines](#commit-message-guidelines)
- [Submitting a Pull Request](#submitting-a-pull-request)
- [Project Structure](#project-structure)

## Code of Conduct

Please be respectful and constructive in all interactions. We're here to build something great together.

## Getting Started

1. **Fork the repository** on GitHub
2. **Clone your fork** locally:
   ```bash
   git clone https://github.com/YOUR_USERNAME/rspress-language-tabs.git
   cd rspress-language-tabs
   ```
3. **Add upstream remote**:
   ```bash
   git remote add upstream https://github.com/maccuaa/rspress-language-tabs.git
   ```

## Development Setup

This project uses [Bun](https://bun.sh/) as the package manager and runtime.

### Prerequisites

- Bun 1.3.1 or higher
- Node.js 20+ (for npm publishing)

### Install Dependencies

```bash
bun install
```

### Available Scripts

```bash
bun run dev              # Build in watch mode
bun run build            # Build the plugin
bun run lint             # Run all linters (Biome + Prettier)
bun run lint:js          # Run Biome linter on code
bun run lint:md          # Check Markdown/MDX formatting
bun run lint:commits     # Validate commit messages (last 10 commits)
bun run format           # Format all files (Biome + Prettier)
bun run format:biome     # Format code files with Biome
bun run format:prettier  # Format Markdown/MDX with Prettier
```

### Website

The `website` directory contains an Rspress site for testing the plugin:

```bash
cd website
bun run dev       # Start dev server at http://localhost:3000
bun run build     # Build the website
```

## Making Changes

### Code Style

This project uses a **dual-formatter** approach:

- **Biome**: Linting and formatting for TypeScript, JavaScript, JSON, and other code files
- **Prettier**: Formatting for Markdown (`.md`) and MDX (`.mdx`) documentation files only

**Configuration Files:**

- `biome.json` - Biome configuration for code files
- `.prettierrc` - Prettier configuration (Markdown/MDX only)
- `.prettierignore` - Excludes CHANGELOG.md (auto-generated by Release Please) and build outputs

**Code Style Guidelines:**

- Use TypeScript for all source files
- Prefer functional components with hooks for React components
- Export types for all public APIs
- Use meaningful variable and function names
- Add JSDoc comments for public APIs
- Keep functions small and focused

### Making Code Changes

1. **Create a feature branch** from `main`:

   ```bash
   git checkout -b feat/your-feature-name
   # or
   git checkout -b fix/your-bug-fix
   ```

2. **Make your changes** following the code style:
   - Run `bun run format` to auto-format your code
   - Run `bun run lint` to check for linting errors
   - TypeScript is required for all source files

3. **Test your changes**:
   - Build the plugin: `bun run build`
   - Test in the website: `cd website && bun run dev`
   - Verify icons display correctly in light and dark modes
   - Test TypeScript compilation
   - Verify the package can be built: `bun pm pack --dry-run`

## Testing

Currently, the project uses manual testing via the website. When adding new features:

1. Add examples to `website/docs/examples.mdx`
2. Start the dev server: `cd website && bun run dev`
3. Test in both light and dark modes (use the theme toggle in the UI)
4. Verify icons display correctly for all added languages
5. Check that icons are properly colored and visible
6. Verify TypeScript compilation: `bun run build`
7. Check that the build completes successfully: `bun pm pack --dry-run`

Future: We plan to add automated tests.

### Website Structure

The `website` directory is a fully functional Rspress site that uses the plugin:

- `docs/index.mdx` - Homepage with basic examples
- `docs/examples.mdx` - Comprehensive examples showcasing all features
- `rspress.config.ts` - Rspress configuration
- Built output goes to `doc_build/`

## Commit Message Guidelines

This project uses [Conventional Commits](https://www.conventionalcommits.org/) for automated changelog generation and semantic versioning.

## Format

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

## Types

- **feat**: A new feature (triggers minor version bump)
- **fix**: A bug fix (triggers patch version bump)
- **docs**: Documentation only changes
- **style**: Changes that don't affect code meaning (formatting, etc.)
- **refactor**: Code change that neither fixes a bug nor adds a feature
- **perf**: Performance improvement
- **test**: Adding or updating tests
- **chore**: Maintenance tasks, dependency updates
- **ci**: CI/CD configuration changes
- **build**: Build system or dependency changes
- **revert**: Revert a previous commit

## Breaking Changes

Add `!` after the type or add `BREAKING CHANGE:` in the footer:

```bash
feat!: drop support for Node 16

BREAKING CHANGE: Node 16 is no longer supported
```

This triggers a major version bump.

## Examples

### Good ‚úÖ

```bash
feat: add dark mode support for language icons
fix: resolve black icons in dark mode
docs: update installation instructions
chore: upgrade dependencies
feat(icons)!: change icon API to support custom colors
```

### Bad ‚ùå

```bash
Added new feature          # Missing type
fix: Fixed the bug.        # Capital letter, ends with period
updated readme             # Missing type
WIP                        # Not descriptive
```

## Validation

Commits are automatically validated in CI. Non-compliant commits will fail the build.

### Test locally (optional)

```bash
bun run lint:commits
```

### Skip validation (not recommended)

If you absolutely need to bypass validation for a merge commit or similar:

```bash
git commit -m "Merge branch 'feature'" --no-verify
```

Note: CI will still validate, so this only helps locally.

## Why This Matters

- üìù **Automated Changelog**: Good commits = good changelog
- üî¢ **Semantic Versioning**: Commit types determine version bumps
- ü§ñ **Release Automation**: Release Please uses commits to create releases
- üìñ **Clear History**: Easy to understand what changed and why

## Submitting a Pull Request

1. **Push your branch** to your fork:

   ```bash
   git push origin feat/your-feature-name
   ```

2. **Create a Pull Request** on GitHub:
   - Use a clear, descriptive title following conventional commit format
   - Describe what changes you made and why
   - Reference any related issues
   - Include screenshots for UI changes

3. **Wait for review**:
   - CI checks must pass (build, lint, commit messages)
   - A maintainer will review your PR
   - Address any feedback or requested changes

4. **Merge**:
   - Once approved, a maintainer will merge your PR
   - Your contribution will be included in the next release!

## Project Structure

```
rspress-language-tabs/
‚îú‚îÄ‚îÄ src/                          # Source code
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                  # Main entry point (exports components)
‚îÇ   ‚îú‚îÄ‚îÄ languageIcons.tsx         # Icon utilities, mappings, and color adjustment
‚îÇ   ‚îî‚îÄ‚îÄ LanguageTabs.tsx          # LanguageTabs and LanguageTab components
‚îú‚îÄ‚îÄ website/                      # Documentation website
‚îÇ   ‚îú‚îÄ‚îÄ docs/                     # Website documentation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.mdx             # Homepage
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ examples.mdx          # Comprehensive examples
‚îÇ   ‚îú‚îÄ‚îÄ doc_build/                # Built website (git-ignored)
‚îÇ   ‚îú‚îÄ‚îÄ rspress.config.ts         # Website config
‚îÇ   ‚îî‚îÄ‚îÄ package.json              # Website dependencies
‚îú‚îÄ‚îÄ .github/workflows/            # CI/CD pipelines
‚îÇ   ‚îú‚îÄ‚îÄ build.yaml                # Build, lint, and validation checks
‚îÇ   ‚îî‚îÄ‚îÄ release-please.yml        # Automated releases
‚îú‚îÄ‚îÄ biome.json                    # Biome linter/formatter config
‚îú‚îÄ‚îÄ .prettierrc                   # Prettier config (Markdown/MDX only)
‚îú‚îÄ‚îÄ .prettierignore               # Files to exclude from Prettier
‚îú‚îÄ‚îÄ commitlint.config.js          # Commit message validation
‚îú‚îÄ‚îÄ release-please-config.json    # Release automation config
‚îú‚îÄ‚îÄ .release-please-manifest.json # Current version tracking
‚îú‚îÄ‚îÄ rslib.config.ts               # Rslib build configuration
‚îú‚îÄ‚îÄ tsconfig.json                 # TypeScript configuration
‚îú‚îÄ‚îÄ AGENTS.md                     # AI assistant technical context
‚îú‚îÄ‚îÄ CONTRIBUTING.md               # This file - contribution guidelines
‚îî‚îÄ‚îÄ README.md                     # User-facing documentation
```

### Key Files Explained

- **`src/languageIcons.tsx`**: Contains the icon mapping, Simple Icons imports, dark mode color adjustment logic, and the `getLanguageIcon()` function
- **`src/LanguageTabs.tsx`**: React components that wrap Rspress's built-in `<Tabs>` and `<Tab>` components
- **`rslib.config.ts`**: Configures the build process using Rslib (Rspack-based bundler)
- **`biome.json`**: Configures Biome for linting and formatting TypeScript/JavaScript/JSON
- **`.prettierrc`**: Configures Prettier for Markdown/MDX formatting only
- **`commitlint.config.js`**: Enforces conventional commit format
- **`release-please-config.json`**: Configures automated release generation

### Workspace Structure

This project uses Bun workspaces with a catalog for shared dependencies:

```json
{
  "workspaces": {
    "packages": [".", "website"],
    "catalog": {
      "@rspress/core": "2.0.0-beta.35"
    }
  }
}
```

**Benefits:**

- **Single source of truth**: Update Rspress version in one place
- **Consistent versions**: Both root and website use the same Rspress version
- **Easy updates**: Change catalog version, run `bun install`, done

**Usage:**

- Install regular dependencies: `bun add <package>`
- Use catalog dependency in package.json: `"@rspress/core": "catalog:"`
- Update catalog version: Edit root `package.json` and run `bun install`

## Adding Support for New Languages

To add a new language icon:

1. **Check if the icon exists** in [Simple Icons](https://simpleicons.org/)
   - Search for the language name on the Simple Icons website
   - Note the exact icon name (e.g., `siJavascript`, `siPython`)

2. **Add the import** to `src/languageIcons.tsx`:

   ```typescript
   import { siNewLanguage } from "simple-icons";
   ```

3. **Add the mapping** in `languageToIconMap` (alphabetically):

   ```typescript
   const languageToIconMap = {
     // ... other languages
     newlang: siNewLanguage,
     // ... more languages
   };
   ```

4. **Add common aliases** (optional but recommended):

   ```typescript
   // After the main languageToIconMap
   nl: siNewLanguage,  // alias for newlang
   ```

5. **Update the type definition**:

   ```typescript
   export type SupportedLanguage = keyof typeof languageToIconMap;
   ```

   (This happens automatically if you're editing the same file)

6. **Add examples** to `website/docs/examples.mdx`:

   ````mdx
   <LanguageTab language="newlang">
   ```javascript
   // Example code in the new language
   ````

   </LanguageTab>
   ```

7. **Test the new language**:
   - Build and run the website
   - Verify the icon displays correctly
   - Test in both light and dark modes
   - Check that very dark icons are properly adjusted for dark mode

8. **Update documentation**:
   - Add the language to the appropriate section in `README.md`
   - Keep the list alphabetically sorted within each category

### Dark Mode Color Adjustments

Some language icons may have very dark colors that are hard to see in dark mode. The `adjustColorForDarkMode()` function automatically handles this:

- Very dark colors (brightness < 50): Boosted by 2.5x + base 100
- Moderately dark (50-127): Boosted by 2.0x
- Light colors: Slightly dimmed by 0.9x

Test dark mode carefully to ensure the icon is visible and looks good.

## Questions?

- **Bug reports**: [Open an issue](https://github.com/maccuaa/rspress-language-tabs/issues)
- **Feature requests**: [Open an issue](https://github.com/maccuaa/rspress-language-tabs/issues)
- **General questions**: [Open a discussion](https://github.com/maccuaa/rspress-language-tabs/discussions)

## License

By contributing, you agree that your contributions will be licensed under the MIT License.
